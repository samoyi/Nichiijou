<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title></title>
</head>
<body>

</body>
<script>
'use strict';

// async function fetchget(sURL, fnSuccessCallback, fnFailCallback){
//     try{
//         let res = await fetch(sURL);
//         fnSuccessCallback(res);
//     }
//     catch(err){
//         fnFailCallback(err);
//     }
// }
//
// fetchget('test.json', async res=>{
//     let result = await res.json();
//     console.log(result);
// }, err=>{
//     console.log(err);
// });
//
// console.log('start');


function stringify(data){
	let str = '';
	for(let key in data){
		str += (key + '=' + data[key] + '&');
	}
	return str.slice(0, -1);
}

let sURL = 'test.php',
    data = {name: "33", age: 22};
post(sURL, data, resText=>{console.log(resText)});
function post(sURL, data, fnSuccessCallback, fnFailCallback){
    let xhr = new XMLHttpRequest();
    xhr.addEventListener('readystatechange', function()
    {
        if (xhr.readyState == 4)
        {
            if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304){
                // 必要的时候，使用 getResponseHeader() 检查首部信息
                fnSuccessCallback && fnSuccessCallback( xhr.responseText );
            }
            else{
                fnFailCallback && fnFailCallback( xhr.status );
            }
        }
    }, false);
    xhr.open("post", sURL, true);
    // 如果发送FormDate，则不需要设置Content-Type，但截至2017.5，FormDate的浏览器支持并不理想
    // xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    xhr.setRequestHeader("Content-Type", "application/json");
    xhr.send(stringify(data));
}

</script>
</html>
